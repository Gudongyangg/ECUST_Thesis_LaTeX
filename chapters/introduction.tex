
\chapter{简介}


随机模拟算法（SSA）广泛用于模拟具有马尔可夫动力学的复杂系统的时变轨迹（Gillespie，1977）\upcite{BITthesis}。
这些模型背后的一个主要假设是无记忆假设，即反应物的随机动力学仅受系统当前状态的影响，这意味着连续反应事件之间的等待时间遵循指数分布。


许多常见的反应系统封装了涉及大量相互作用物质的多个中间反应步骤（Filatova等人，2021）\upcite{BITthesis}。
这就导致使用SSA进行随机模拟时需要高昂的计算成本，严重限制了在很大一部分参数空间中对动力学过程的探索。
一种可行的替代方法是使用简化模型。虽然理论上如果存在时间尺度分离，就可以进行严格的分析进行模型简化（Mastny et al.，2007；Kan et al.，2016），
但是在实际情况下，通常用一个延迟反应来代替多个中间反应。
通过这种方法就可以获得一个具有非马尔可夫动力学的简化模型，即连续反应事件之间的等待时间是非指数的，这是传统SSA无法模拟的。


几种具有延迟的反应系统的精确模拟方法已经被提出（Barrio等人，2006；Cai，2007；Anderson，2007；Ramaswamy和Sbalzarini，2011）。
其中一些方法可通过软件工具实现（Maarleveld等人，2013年；Barbuti等人，2009年）。
然而，这些软件包提供的功能有限（只能实现少量延迟SSA算法，并且仅限于固定延迟或质量作用反应），对于潜在的用户群来说，功能非常局限。


我们提供的DelaySSAToolkit.jl是首个用于建模时滞随机反应系统的Julia软件包。
反应中的延迟可以是固定的，也可以是随时间变化的，即每次触发延迟反应时，可以从用户定义的概率分布中选择延迟。
还可以对存在相同反应物系统总体的非均相时滞情况进行建模，其中每个反应物系统都有一个具有不同但固定时滞的反应。
此外，此软件包还可以使用各种延迟随机模拟算法集成同步延迟反应和延迟反应级联。
有关Delay SSA理论和软件使用教程的全面教程，请访问https://github.com/palmtree2013/DelaySSAToolkit.jl。 


\section{模型与方法}

延迟反应系统的定义包括两部分，即反应发生瞬间就影响反应物状态的马尔可夫部分和反应发生在一定时间延迟$\tau$后，反应物状态才发生变化的非马尔可夫部分（图1a）。
反应网络的马尔可夫部分可以通过使用Julia符号数字建模框架————Catalyst.jl（https://github.com/SciML/Catalyst.jl）和ModelingToolkit.jl（Ma等人，2021）工具包，再指定化学计量比和反应倾向来构建。
另一种方法是使用较低级别的编程接口————DifferqJump.jl（https://github.com/SciML/DiffEqJump.jl）工具包，手动定义每个反应的化学计量数和倾向函数。 

DelaySSAToolkit.jl通过指定即时反应和由其触发的延迟反应之间的因果关系，将上述定义的马尔可夫模型扩展到延迟系统。
因此，DelaySSAToolkit.jl可以处理包含任意数量物质和反应的非马尔可夫系统，其中系统中的物质和反应可以是任意类型的光滑倾向函数和广泛的延迟类型。



DelaySSAToolkit.jl的算法实现是基于DiffEqJump.jl提供的SSA算法和DiffEqJump.jl提供的解决算法处理程序。
它目前支持四种延迟随机模拟算法：延迟拒绝法（Bratsun et al.，2005；Barrio et al.，2006）、延迟直接法（Cai，2007）、延迟修正下一反应法（Anderson，2007）
和具有组成和拒绝的延迟直接法（Slepoy et al.，2008；Mauch和Stalzer，2011）。
延迟拒绝法和延迟直接方法在反应数量小的反应网络表现的性能更好，而其他两种方法则更适合于反应数量较多的系统。
使用(Gibson和Bruck，2000)中描述的依赖图和优先级队列，提高了反应数量较多的大规模网络中延迟修正下一反应法和具有组合和拒绝的延迟直接法的计算效率。
使用DifferentialEquations.jl中提供的高性能多线程/多处理并行计算接口，可以轻松实现集成仿真。同时这个工具包还提供了一些数值分析和参数估计工具，可以进一步研究由它产生的延迟系统。
延迟SSA问题的结果可以依据用户指定的需要，造时间点或在确切的事件时间点给出。每个SSA问题的结果的数据结构由三部分组成：时间点、反应物状态和对应时间点的延迟通道状态。
延迟通道的记录状态在某些情况下特别有用，例如，当模拟基因转录时，延迟反应用于模拟转录起始和终止之间的时间，并且从延迟通道的状态可以重建RNA聚合酶在基因上的位置（Fu等人，2021）。 

